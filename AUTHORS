Original author: Ivan Sagalaev <maniac@softwaremaniacs.org>
